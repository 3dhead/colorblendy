if(typeof String.prototype.trim!=="function"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}function assure_hash_prefix(a){if(a[0]=="#"||!(/^[\dabcdef]{3,6}$/).test(a)){return a}return"#"+a}function hex_to_rgb(a){if(a[0]=="#"){a=a.substring(1,7)}if(a.length<6){a+="000000".substr(0,6-a.length)}return[parseInt(a.substring(0,2),16),parseInt(a.substring(2,4),16),parseInt(a.substring(4,6),16)]}function rgb_to_hex(a){var b=(a[2]|(a[1]<<8)|(a[0]<<16)).toString(16);return"000000".substr(0,6-b.length)+b}function css_to_rgb(a){if(a[0]=="#"){return hex_to_rgb(a)}return $.map(a.substring(4,a.length-1).split(","),function(b){return parseInt(b.trim())})}function rgb_to_css(a){return"rgb("+a[0]+","+a[1]+","+a[2]+")"}function rgb_a_to_css(c,b){return"rgba("+c[0]+","+c[1]+","+c[2]+","+b+")"}function rgb_to_hsv(i){var c=i[0]/255,e=i[1]/255,j=i[2]/255;var k=Math.max(c,e,j),d=Math.min(c,e,j);if(k==d){return[0,0,k]}var m=k,n=(k-d)/k;var a=(k-c)/(k-d),l=(k-e)/(k-d),f=(k-j)/(k-d);if(c==k){h=f-l}else{if(e==k){h=2+a-f}else{h=4+l-a}}h=(h/6)%1;if(h<0){h+=1}return[h,n,m]}function hsv_to_rgb(e){var d=e[0],l=e[1],j=e[2]*255;if(l==0){return[j,j,j]}var c=Math.floor(d*6);var g=(d*6)-c;var b=j*(1-l);var a=j*(1-l*g);var k=j*(1-l*(1-g));var c=c%6;if(c==0){return[j,k,b]}if(c==1){return[a,j,b]}if(c==2){return[b,j,k]}if(c==3){return[b,a,j]}if(c==4){return[k,b,j]}if(c==5){return[j,b,a]}}function rgb_to_hsl(k){var c=k[0]/255,i=k[1]/255,m=k[2]/255;var n=Math.max(c,i,m),e=Math.min(c,i,m);var f,p,d=(e+n)/2;if(e==n){return[0,0,d]}if(d<=0.5){p=(n-e)/(n+e)}else{p=(n-e)/(2-n-e)}var a=(n-c)/(n-e);var o=(n-i)/(n-e);var j=(n-m)/(n-e);if(c==n){f=j-o}else{if(i==n){f=2+a-j}else{f=4+o-a}}f=(f/6)%1;if(f<0){f+=1}return[f,p,d]}function hsl_to_rgb(i){var d=i[0],m=i[1],c=i[2];var k,j;if(m==0){return[c*255,c*255,c*255]}if(c<=0.5){j=c*(1+m)}else{j=c+m-(c*m)}k=2*c-j;var a=hue_to_rgb(k,j,d+(1/3)),e=hue_to_rgb(k,j,d),f=hue_to_rgb(k,j,d-(1/3));return[255*a,255*e,255*f]}function hue_to_rgb(c,b,a){if(a<0){a+=1}if(a>1){a-=1}if((6*a)<1){return c+(b-c)*6*a}if((2*a)<1){return b}if((3*a)<2){return c+(b-c)*((2/3)-a)*6}return c}function invert_rgb(a){return[255-a[0],255-a[1],255-a[2]]}function apply_filter(c,a,b){return[b(c[0],a[0]),b(c[1],a[1]),b(c[2],a[2])]}var blend_filters={multiply:function(b,a){return(a*b)/255},screen:function(b,a){return 255-(((255-a)*(255-b))>>8)},overlay:function(b,a){return(b<128)?(2*a*b/255):(255-2*(255-b)*(255-a)/255)},dodge:function(b,a){return b==255?b:Math.min(255,(a<<8)/(255-b))},burn:function(b,a){return b==0?b:Math.max(0,(255-((255-a)<<8)/b))},negate:function(b,a){return 255-Math.abs(255-b-a)}};function blend(d,b,a){var e=apply_filter(b,a,blend_filters[d]);return[Math.min(Math.round(e[0]),255),Math.min(Math.round(e[1]),255),Math.min(Math.round(e[2]),255)]};